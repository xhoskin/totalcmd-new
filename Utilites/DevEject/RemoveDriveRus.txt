RemoveDrive V1.4 - ПОДГОТАВЛИВАЕТ сменные диски к безопасному удалению.Freeware by Uwe Sieber - www.uwe-sieber.de

Работает только под Window 2000, XP, Server 2003 и Vista.-------------------------------------------------------Использование:
RemoveDrive DriveSpec: [-l][-h][-w:nnnn]
DriveSpec: - буква диска, который надо отключить, напр. е:[-l] повторять в цикле до успешного завершения[-b] Показывает в Windows баллон-подсказку "Теперь съёмный диск можно безопасно     отключить"[-h] Показать открытые процессы с этим диском, чем или кем занят этот диск     (нужны админские права, эксперимент, может повесить систему!)[-w:nnnn] Ожидание nnnn миллисекунд перед закрытием окна программы[-d] Показать отладочную информацию
или
RemoveDrive "DeviceName" [-l]
DeviceName - имя устройства напр. "Corsair Flash Voyager USB Device" или коротко"Corsair Flash Voyagerr", как показано в диалоге 'безопасного удаления'Админские права не требуются :-)
Возвращаемые коды ошибок:0 - успешноe удаление устройства1 - устройство идентифицировано, но не удалено2 - устройство не обнаружено или неверные параметры4 - RemoveDrive.exe расположен на накопителе, который удаляется ->    созданна временная копия и выполнилась
Если удаление не удалось, значит, кто-нибудь все ещё имеет доступ к накопителю.Это может быть что-то банальным, подобно открытому текстовому документу илинекоторому типу проверки средства подобно вирусному сканеру или SMART-инструмент.Можно использовать SysInternals ProcessExplorer, чтобы обнаружить, какая программане даёт доступ к отключаеммому диску.http://www.sysinternals.com/Utilities/ProcessExplorer.htmlПосле старта, запускаем 'Поиск -> 'Поиск Процесса или DLL', ввести бкуву диска,например X:\ и ищем, какой процесс держит съёмный диск.